<!-- file: /map/index.html -->
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trans-Time ‚Äî –ö–∞—Ä—Ç–∞</title>

  <!-- üîê CSP -->
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'self';
             base-uri 'self';
             object-src 'none';
             frame-ancestors 'self';
             form-action 'self';
             script-src 'self' 'unsafe-inline'
                        https://api-maps.yandex.ru
                        https://yastatic.net
                        https://*.yastatic.net
                        https://core-renderer-tiles.maps.yandex.net
                        https://*.maps.yandex.net;
             script-src-elem 'self' 'unsafe-inline'
                        https://api-maps.yandex.ru
                        https://yastatic.net
                        https://*.yastatic.net
                        https://core-renderer-tiles.maps.yandex.net
                        https://*.maps.yandex.net;
             style-src 'self' 'unsafe-inline' https://yastatic.net https://*.yastatic.net blob:;
             style-src-elem 'self' 'unsafe-inline' https://yastatic.net https://*.yastatic.net blob:;
             img-src 'self' data:
                     https://yastatic.net https://*.yastatic.net
                     https://yandex.ru https://*.yandex.ru
                     https://*.yandex.net;
             font-src 'self' https://yastatic.net https://*.yastatic.net data:;
             connect-src 'self'
                         https://api-maps.yandex.ru
                         https://*.yandex.ru
                         https://*.yandex.net
                         https://*.yastatic.net
                         https://core-renderer-tiles.maps.yandex.net
                         https://*.maps.yandex.net;
             frame-src https://yandex.ru https://api-maps.yandex.ru;
             worker-src 'self' blob:;
             manifest-src 'self';">

  <style>
    :root {
      --bg: #0b0b0d;
      --fg: #ececec;
      --muted: #a0a0a0;
      --accent: #4da3ff;
      --surface: #111218;
      --border: #262733;
      --chip-bg: #181922;
      --chip-border: #2b2c38;
      --danger: #ef4444;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      height: 100%;
      font-family: system-ui, -apple-system, sans-serif;
      background: var(--bg);
      color: var(--fg);
    }

    #map {
      width: 100%;
      height: 100vh;
      background: #050506;
    }

    .tt-panel {
      position: absolute;
      top: 76px;
      right: 20px;
      width: 320px;
      max-width: 90vw;
      background: var(--surface);
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
      color: var(--fg);
      z-index: 500;
      max-height: calc(100vh - 100px);
      overflow-y: auto;
      display: none; /* –ø–æ–∫–∞–∂–µ–º –∏–∑ JS */
    }

    /* –®–∞–ø–∫–∞-–ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–ª–∫–∞ –ø–∞–Ω–µ–ª–∏ */
    .tt-panel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: -8px -8px 8px -8px;
      padding: 8px 10px;
      border-radius: 10px;
      background: #181922;
      cursor: grab;
      user-select: none;
    }

    .tt-panel-header-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--fg);
    }

    .tt-panel-header-hint {
      font-size: 11px;
      color: var(--muted);
    }

    .tt-panel-header.dragging {
      cursor: grabbing;
    }

    .tt-section {
      margin-bottom: 16px;
    }

    .tt-veh {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .tt-chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid var(--chip-border);
      background: var(--chip-bg);
      font-size: 13px;
      cursor: pointer;
    }

    .tt-chip input {
      display: none;
    }

    .tt-chip.active,
    .tt-chip input:checked ~ span {
      background: rgba(77, 163, 255, 0.16);
      border-color: var(--accent);
      color: var(--accent);
    }

    .tt-field {
      margin: 8px 0;
    }

    .tt-field label {
      font-size: 12px;
      color: var(--muted);
      display: block;
      margin-bottom: 4px;
    }

    .tt-input {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: #15161d;
      color: var(--fg);
      font-size: 14px;
    }

    .tt-input:focus {
      outline: none;
      border-color: var(--accent);
    }

    .tt-btn {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 8px;
      background: linear-gradient(135deg, #4da3ff, #6bb8ff);
      color: #081018;
      font-weight: 700;
      cursor: pointer;
      margin-top: 8px;
    }

    .tt-btn:disabled {
      background: #262836;
      color: #777;
      cursor: not-allowed;
    }

    .tt-toggle {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
    }

    .tt-toggle input {
      accent-color: var(--accent);
    }

    .loader {
      text-align: center;
      padding: 20px;
      color: var(--muted);
      font-size: 14px;
    }

    /* –°–ø–∏—Å–æ–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ */
    .tt-route-list {
      margin-top: 8px;
      border-top: 1px solid var(--border);
      padding-top: 8px;
      max-height: 200px;
      overflow-y: auto;
      font-size: 13px;
    }

    .tt-route-item {
      padding: 6px 8px;
      border-radius: 6px;
      cursor: pointer;
      margin-bottom: 4px;
      background: #15161d;
      border: 1px solid transparent;
    }

    .tt-route-item:hover {
      border-color: var(--accent);
    }

    .tt-route-item.active {
      border-color: var(--accent);
      background: rgba(77, 163, 255, 0.12);
    }

    .tt-route-title {
      font-weight: 500;
      margin-bottom: 2px;
    }

    .tt-route-meta {
      font-size: 12px;
      color: var(--muted);
    }
  </style>
</head>
<body>

  <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ä—Ç—ã -->
  <div id="loader" class="loader">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç—ã...</div>

  <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–∞—Ä—Ç—ã -->
  <div id="map" style="display: none;"></div>

  <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
  <div class="tt-panel">
    <div class="tt-panel-header">
      <div class="tt-panel-header-title">–ú–∞—Ä—à—Ä—É—Ç Trans-Time</div>
      <div class="tt-panel-header-hint">–ü–∞–Ω–µ–ª—å –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç—å</div>
    </div>

    <div class="tt-section">
      <div class="tt-field">
        <label for="from">–û—Ç–∫—É–¥–∞</label>
        <input type="text" id="from" class="tt-input" placeholder="–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å..." />
      </div>
      <div class="tt-field">
        <label for="to">–ö—É–¥–∞</label>
        <input type="text" id="to" class="tt-input" placeholder="–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å..." />
      </div>
      <button id="buildBtn" class="tt-btn" disabled>–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç</button>
    </div>

    <div class="tt-section">
      <div class="tt-veh">
        <label class="tt-chip">
          <input type="radio" name="veh" value="truck40" checked />
          <span>–§—É—Ä–∞ 40 —Ç</span>
        </label>
        <label class="tt-chip">
          <input type="radio" name="veh" value="truck24" />
          <span>–§—É—Ä–∞ 24 —Ç</span>
        </label>
        <label class="tt-chip">
          <input type="radio" name="veh" value="car" />
          <span>–õ–µ–≥–∫–æ–≤–æ–π</span>
        </label>
      </div>
    </div>

    <div class="tt-section">
      <details class="tt-details" open>
        <summary>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¢–°</summary>
        <div>
          <div class="tt-field">
            <label>–í–µ—Å, —Ç</label>
            <input type="number" id="truckWeight" class="tt-input" value="40" min="0" max="100" step="0.1">
          </div>
          <div class="tt-field">
            <label>–í—ã—Å–æ—Ç–∞, –º</label>
            <input type="number" id="truckHeight" class="tt-input" value="4.0" min="0" max="10" step="0.1">
          </div>
          <div class="tt-field">
            <label>–®–∏—Ä–∏–Ω–∞, –º</label>
            <input type="number" id="truckWidth" class="tt-input" value="2.55" min="0" max="5" step="0.01">
          </div>
          <div class="tt-field">
            <label>–î–ª–∏–Ω–∞, –º</label>
            <input type="number" id="truckLength" class="tt-input" value="16" min="0" max="30" step="0.1">
          </div>
        </div>
      </details>
    </div>

    <div class="tt-section">
      <div class="tt-saved-title">–ò–∑–±—Ä–∞–Ω–Ω—ã–µ</div>
      <ul id="savedRoutesList" class="tt-saved-routes">
        <!-- –Ω–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è storage.js -->
      </ul>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ -->
    <div class="tt-section">
      <div style="font-size:12px; color:var(--muted); margin-bottom:4px;">–í–∞—Ä–∏–∞–Ω—Ç—ã –º–∞—Ä—à—Ä—É—Ç–∞</div>
      <div id="routeList" class="tt-route-list">
        <!-- –Ω–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è router.js -->
      </div>
    </div>

    <div class="tt-section">
      <label class="tt-toggle">
        <span>–ü–æ–∫–∞–∑–∞—Ç—å —Ä–∞–º–∫–∏</span>
        <input type="checkbox" id="toggle-frames" checked />
      </label>
    </div>
  </div>

  <!-- –ú–æ–¥—É–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–∞—Ä—Ç—ã Trans-Time -->
  <script type="module" src="./assets/js/boot.js"></script>
</body>
</html>
