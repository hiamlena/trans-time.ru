AddDefaultCharset UTF-8
Options -Indexes +FollowSymLinks

# ---------------------------------------
# üîí –ü—Ä–æ–ø—É—Å–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤/–ø–∞–ø–æ–∫
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule - [L]

# ---------------------------------------
# üåê –ö–∞–Ω–æ–Ω–∏–∑–∞—Ü–∏—è: HTTPS + –±–µ–∑ www
RewriteCond %{HTTP_HOST} !^trans-time\.ru$ [OR]
RewriteCond %{HTTPS} !=on
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule ^ https://trans-time.ru%{REQUEST_URI} [R=301,L]

# ---------------------------------------
# üß† MIME-—Ç–∏–ø—ã
AddType application/json .geojson
AddType "application/javascript; charset=UTF-8" .js
AddType "text/css; charset=UTF-8" .css
AddType "image/svg+xml; charset=UTF-8" .svg

# ---------------------------------------
# üõ°Ô∏è Content Security Policy (CSP)
# ‚úÖ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è, –±–µ–∑ 500, –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã
<IfModule mod_headers.c>
Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' blob: https://api-maps.yandex.ru https://yastatic.net https://*.yastatic.net https://*.yandex.net; script-src-elem 'self' 'unsafe-inline' blob: https://api-maps.yandex.ru https://yastatic.net https://*.yastatic.net https://*.yandex.net; connect-src 'self' https://api-maps.yandex.ru https://yastatic.net https://*.yastatic.net https://geocode-maps.yandex.ru https://router-maps.yandex.ru; img-src 'self' data: blob: https://yastatic.net https://*.yastatic.net https://*.yandex.ru https://*.yandex.net https://*.maps.yandex.net https://core-renderer-tiles.maps.yandex.net; style-src 'self' 'unsafe-inline' https://yastatic.net https://*.yastatic.net; font-src 'self' data: https://yastatic.net https://*.yastatic.net; worker-src blob:"
</IfModule>

# ---------------------------------------
# üö´ –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫—ç—à–∞ (—á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ä–∞–∑—É)
<IfModule mod_headers.c>
Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
Header set Pragma "no-cache"
Header set Expires "0"
</IfModule>

# ---------------------------------------
# üß© CSP Report ‚Äî –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –ø–æ–∑–∂–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
# ‚ö†Ô∏è –ø–æ–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–æ, —á—Ç–æ–±—ã –Ω–µ —Å–ø–∞–º–∏–ª–æ F12
# <IfModule mod_headers.c>
# Header always set Content-Security-Policy-Report-Only "default-src 'self'; report-uri /map/csp-report.php; report-to csp-endpoint"
# Header always set Report-To "{\"group\":\"csp-endpoint\",\"max_age\":10800,\"endpoints\":[{\"url\":\"/map/csp-report.php\"}]}"
# </IfModule>

# ---------------------------------------
# üßπ –ö—ç—à –∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
Header unset ETag
FileETag None
